\documentclass[12pt,a4paper,french]{article}

\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{fullpage}
\usepackage[french]{babel} 
\usepackage[official]{eurosym}
\usepackage{txfonts}
\usepackage{graphicx}
\usepackage{lastpage}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{color}
\usepackage{setspace}
\usepackage[nottoc, notlof, notlot]{tocbibind}
\usepackage{hyperref}
\usepackage[french,ruled,vlined]{algorithm2e}
\usepackage{algorithmic}

\begin{document}

\title{Algorithmes -- Emploi du temps}
\author{Coudray -- Julien -- Tran}
\date{\today}
\maketitle

\section{Pré-traitements}
Avant de réaliser l'emploi du temps, le programme procède à des vérifications sur les données d'entrées afin de détecter toutes les incohérences. Ainsi, il élimine au préalable une partie des traitements qui n'aboutiront pas.

\subsection{Le nombre de professeur}
La première vérification concerne le nombre de professeurs en entrée. Nous vérifions s'il y a assez de professeurs pour dispenser les cours de chaque classe.
Ainsi pour un cours donné, l'algorithme somme les disponibilités des professeurs puis compare le résultat au nombre de classe.\\
Si le cours est sur 4 heures, alors la somme des disponibilités est divisée par 2. En effet, le cours en question nécessite deux créneaux consécutifs pour être dispensé.\\

Soit $n$ le nombre de professeurs pouvant donner un cours $c$ et $m$ le nombre de classe devant suivre ce cours.
Pour un cours de 2 heures, nous avons:
\begin{center}
$\sum_{i=0}^n dispo_{prof_i} > m$
\end{center}

Pour un cours de 4 heures, nous avons: 
\begin{center}
$\frac{\sum_{i=0}^n dispo_{prof_i}}{2} > m$
\end{center}

L'opération est répétée pour l'ensemble des cours. 

\begin{algorithm}
\caption{Pré-traitement nombre de professeurs}
\begin{algorithmic}
\FORALL{$Courses$}
\STATE $idCourse \leftarrow$ identifiant de $Courses$
\STATE $idPromo \leftarrow$ identifiant de la promotion recevant $Courses$
\STATE $nbClasses \leftarrow$ nombre de classe de la promotion $idPromo$
\FORALL{$Profs$}
\IF {$Profs$ donne le cours $idCourse$}
\FORALL {$CreneauxProf$}
\IF {$Profs$ est disponible}
\STATE $nbCreneaux \leftarrow nbCreneaux + 1$
\ENDIF
\ENDFOR
\ENDIF
\ENDFOR
\IF {$Courses$ est sur 4h}
\STATE $nbCreneaux \leftarrow nbCreneaux / 2$
\ENDIF
\IF{$nbClasses > nbCreneaux$}
\STATE display (Erreur sur le nombre de professeur pour la promo $idPromo$)
\STATE EXIT FAILURE
\ENDIF
\ENDFOR
\STATE display (Nombre de professeurs ok)
\end{algorithmic}
\end{algorithm}

\newpage

\subsection{Le nombre de cours total sur le semestre}
La seconde vérification porte sur le nombre d'heures de cours à dispenser à une classe. Ce nombre ne doit pas excéder la totalité des heures du semestre. Le programme somme l'ensemble des cours que possède une classe et le compare au nombre d'heures du semestre.

Soit $n$ le nombre de cours d'une classe $p$, $s$ le nombre de semaines sur un semestre, $c$ le nombre de créneaux sur une semaine et $h$ le nombre d'heures d'un créneau: 

\begin{center}
$\sum_{i=0}^n nbHeures_{cours_i} \leq s*c*h$
\end{center}

\begin{algorithm}
\caption{Pré-traitement nombre d'heures sur le semestre}
\begin{algorithmic}
\FORALL{$Classes$}
\STATE $listCourses \leftarrow$ ensemble des cours que suit une classe
\FORALL {$courses$ in $listCourses$}
\STATE $nbHours \leftarrow nbHours +$ nombre d'heures du cours $courses$
\ENDFOR
\IF {$nbHours$ > (nombre de semaines du semestre * nombre de créneaux par semaine * nombre d'heures par créneau)}
\STATE display(Erreur, trop d'heures pour la classe $Classes$)
\STATE EXIT FAILURE
\ENDIF
\ENDFOR
\STATE display(Nombre d'heures de cours ok)
\end{algorithmic}
\end{algorithm}

Une fois ces pré-traitements réalisés, nous pouvons commencer la conception de l'emploi du temps de l'école.

\newpage
\section{Réalisation de l'emploi du temps}
La réalisation de l'emploi du temps se déroule en deux étapes qui sont réalisées indépendamment pour chaque promotion. Chaque classe d'une promotion suit le même programme avec la même liste d'enseignants potentiels.
C'est pourquoi chaque promotion va avoir un emploi du temps sur le semestre. A savoir, la planification des cours indiquant la semaine de début et de fin.
Enfin, un emploi du temps final sera réalisé semaine par semaine avec chaque cours placés sur ses créneaux respectifs.
\begin{algorithm}
\caption{Principe général de conception des emplois du temps}
\begin{algorithmic}
\FORALL{$Promo$}
\STATE $idCourses \leftarrow$ liste de tous les cours que doivent suivre la promotion $Promo$
\STATE repartitionCoursSemestre($idCourses, programmeSemestre$)
\STATE repartitionCoursPromotions($Promo, programmeSemestre$)
\ENDFOR
\end{algorithmic}
\end{algorithm}

\subsection{Répartition du programme sur le semestre}
La première étape de l'algorithme de résolution est de répartir de l'ensemble du programme de chaque promotion sur le semestre. Cette étape consiste à indiquer pour chaque cours la date de début et de fin semaine.\\

La répartition se déroule en deux étapes : 
\begin{itemize}
\item Le trie des cours 
\item Le placement des cours sur le semestre\\
\end{itemize}

L'objectif est de répartir au mieux les cours sur le semestre. Il faut donc réussir à placer le maximum de cours les uns à la suite des autres. C'est pourquoi nous plaçons les cours les plus longs en premier, puis nous vérifions s'il est possible de placer un nouveau cours derrière ceux-là, sinon nous le plaçons en début de semestre.\\

Un cours de 4 heures impose plus de contraintes. En effet, il s'agit d'un cours où le professeur et la classe doivent avoir deux créneaux consécutifs dans la même demi-journée. C'est pourquoi un cours de 4 heures doit être planifié sur le semestre avant un cours de 2 heures.\\

Pour se faire, les cours vont être séparés en deux listes : une pour les cours de 4 heures et une autre pour les cours de 2 heures. Ainsi pour chacunes des listes, un trie décroissant est effectué par rapport au nombre de semaines sur lequel les cours vont être suivis.\\

$semaineDebut_{coursPlace} + nbSemaine_{coursPlace} + nbSemaine_{nouveauCours} \leq nbSemaine_{semestre}$\\

Chaque élément du semestre va avoir les informations suivantes :
\begin{itemize}
\item L'identifiant du cours
\item Le numéro du début de la semaine
\item Le nombre de semaine du cours
\item Le cours qui le suit
\end{itemize}

\begin{algorithm}
\caption{Algorithme principale de la répartition des cours sur le semestre}
\begin{algorithmic}
\REQUIRE liste $idCourse$, liste $programmeSemestre$
\FORALL {$idCourse$}
\IF {$idCourse$ est un cours sur 2h}
\STATE $idCourses2 \leftarrow$ pushback $idCourses$
\ELSE
\STATE $idCourses4 \leftarrow$ pushback $idCourses$
\ENDIF
\ENDFOR
\STATE Trie de $idCourses2$ par nombre de semaine de cours décroissant
\STATE Trie de $idCourses4$ par nombre de semaine de cours décroissant
\STATE $idCourses$ est vider
\STATE $idCourses \leftarrow$ pushback $idCourses4$
\STATE $idCourses \leftarrow$ pushback $idCourses2$
\STATE $programmeSemestre \leftarrow$ repartitionDesCours($idCourses$)
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{repartitionDesCours($idCourses$)}
\begin {algorithmic}
\REQUIRE liste $idCourses$ triée par nombre de semaine d'un cours et par cours de 4H et 2H
\STATE initialisation de $coursProgrammes$
\FORALL {$idCourses$}
\FORALL {$coursProgrammes$}
\IF {$programmeSemestre$ a cours placé}
\STATE checkNextCourse($idCourses, coursProgrammes$)
\IF {$idCourses$ a été programmé}
\STATE $coursPlace \leftarrow true$
\STATE BREAK
\ENDIF
\ENDIF
\ENDFOR
\IF {$coursPlace == false$}
\STATE $coursProgrammes \leftarrow$ pushback $idCourses$ en début de semestre
\ENDIF
\ENDFOR
\RETURN $coursProgrammes$
\end{algorithmic}
\end{algorithm}

\begin{algorithm}
\caption{checkNextCourse($idCourses, coursProgrammes$)}
\begin {algorithmic}
\IF {$coursProgrammes$ a un cours après lui déja}
\STATE checkNextCourse($idCourses, coursProgrammes$ du cours suivant)
\ELSIF {$semaineDebut_{coursProgrammes} + nbSemaine_{coursProgramme} + nbSemaine_{idCourses} \leq nbSemaine_{semestre}$}
\STATE $coursProgramme \leftarrow$ pushBack $idCourses$
\ENDIF
\end{algorithmic}
\end{algorithm}



\end{document}